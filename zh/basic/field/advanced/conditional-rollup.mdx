---
title: "条件汇总"
---

## 一、功能简介

条件汇总是一种跨表数据查询功能，在筛选数据的基础上进行统计计算，返回单个聚合结果值。它允许您根据设定的筛选条件，从其他表中获取符合要求的数据并进行统计分析，无需预先建立表之间的关联关系。

- **条件聚合**：只对符合条件的数据进行统计，排除无关数据
- **多维统计**：支持求和、计数、平均值等多种计算方式
- **实时更新**：源数据变化时自动重新计算，确保数据准确性

## 二、操作流程

**步骤1：创建条件汇总字段**
1. 点击字段名最右侧的 + 图标
2. 选择"条件汇总"字段类型
3. 输入字段标题（如"总销售额"）

**步骤2：选择目标数据表**
1. 在"目标表选择"下拉菜单中选择要查询的数据表
2. 系统将显示该表的字段列表供后续配置

**步骤3：配置汇总字段**
1. 在"汇总字段"中选择要进行统计计算的数据字段
2. 确定数据类型（数值、文本、日期等）

**步骤4：设置筛选条件**
1. 点击"添加筛选条件"
2. 选择要筛选的字段
3. 选择条件类型（等于、不等于、包含、大于、小于、早于、晚于等）
4. 设置比较值：
   - 静态值：直接输入具体数值
   - 字段引用：选择当前表的字段作为动态值

**步骤5：选择聚合函数**

- 根据数据类型选择合适的计算方式：原值、去重、去重计数、求和、计数、平均值、最大值、最小值等计算方式；

## 三、场景实践

### 场景1：团队任务量统计

<img
  src="/images/2025-11-21-19-42-20.png"
  style={{width: "800px", height: "auto"}}
  alt="任务量统计"
/>

**数据表：**
- 任务表
- 统计表

**场景：**
团队管理员需要统计每个员工不同状态的任务数量，包括进行中、已完成等状态的任务量，用于工作负载管理和进度跟踪。

**操作步骤：**

**进行中任务数**
1. 在员工信息表中新建条件汇总字段，标题设为"进行中任务数"
2. 目标表选择：任务分配表
3. 汇总字段选择：任务ID
4. 筛选条件设置：
   - 字段：负责人 → 条件：等于 → 值：当前表的员工字段
   - 字段：任务状态 → 条件：等于 → 值："进行中"
5. 聚合函数选择：全计数

**已完成任务数**
1. 再次新建条件汇总字段，标题设为"已完成任务数"
2. 目标表选择：任务分配表
3. 汇总字段选择：任务ID
4. 筛选条件设置：
   - 字段：负责人 → 条件：等于 → 值：当前表的员工字段
   - 字段：任务状态 → 条件：等于 → 值："已完成"
5. 聚合函数选择：全计数

### 场景2：查找重复值

<img
  src="/images/2025-11-21-19-44-00.png"
  style={{width: "500px", height: "auto"}}
  alt="查找重复值"
/>

**数据表：**
- 客户表（包含客户名称、联系电话等字段）

**场景：**
在客户表中查找重复的客户名称，识别重复客户记录，用于数据清洗和客户信息管理。

**操作步骤：**
1. 在客户表中新建条件汇总字段，标题设为"客户名称重复次数"
2. 目标表选择：客户表（本表）
3. 汇总字段选择：客户名称
4. 筛选条件设置：
   - 字段：客户名称 → 条件：等于 → 值：当前表的客户名称字段
5. 聚合函数选择：全计数
6. 新建公式字段，标题设为"重复标记"
7. 公式设置：`IF(客户名称重复次数 > 1, "❗️ 重复", BLANK())`

**效果：** 客户表中会显示每个客户名称的出现次数，并且在重复记录旁显示"❗️ 重复"标记，便于快速识别和处理重复数据。

## 四、常见问题

<Accordion title="条件汇总和条件查找有什么区别？">
主要区别在于：
1. **返回结果**：条件汇总返回单个计算值，条件查找返回多个原始值的列表
2. **用途不同**：条件汇总用于统计分析，条件查找用于查看明细数据
3. **计算方式**：条件汇总包含聚合计算，条件查找只是数据筛选和提取
</Accordion>